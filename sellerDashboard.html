<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-commerce SMIT | Seller Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div class="container">
            <h1>Seller Dashboard</h1>
        </div>
    </header>
    <main id="main">
        <button onclick="showAddProductModal()" class="custom-btn btn-1">Add Product</button>
        <center>
        <div id="productList"></div>
    </center>
    </main>
    <center>
        <div id="editProductModal">
            <div class="editProductBox">
                <h1>Edit Product</h1>
                <input id="editItemId" type="number" placeholder="Item ID" disabled>
                <input id="editItemName"  type="text" placeholder="Item Name" required>
                <input id="editItemPrice" type="number" placeholder="Item Price" required>
                <input id="editItemDescription" type="text" placeholder="Item Description" required>
                <input id="editItemURL" type="url" placeholder="Item Image URL" required>
                <button onclick="updateProduct()" class="custom-btn btn-1">Update</button>
                <button onclick="closeEditModal()" class="custom-btn btn-1">Cancel</button>
            </div>
        </div>
    </center>
    
    <center>
        <div id="addProductModal">
            <div class="addProductBox">
                <h1>Add Product</h1>
                <input id="itemId" type="number" placeholder="Item ID" disabled>
                <input id="itemName"  type="text" placeholder="Item Name" required>
                <input id="itemPrice" type="number" placeholder="Item Price" required>
                <input id="itemDescription" type="text" placeholder="Item Description" required>
                <input id="itemURL" type="url" placeholder="Item Image URL" required>
                <button onclick="addProduct()" class="custom-btn btn-1">ADD</button>
            </div>
        </div>
    </center>
    <button onclick="logout()" class="custom-btn btn-1" style="margin: 10px;">LogOut</button>

    <footer>
        <div class="container">
            <p>&copy; 2024 E-commerce Site. SMIT Assignment-MKA.</p>
        </div>
    </footer>
</body>

<script>
        document.getElementById('editProductModal').style.display = 'none';

    var userMail = localStorage.getItem('currentUser');
    var users = JSON.parse(localStorage.getItem('users')) || {}; 
    // Retrieve the current user object or create a new one if it doesn't exist
    var currentUser = users[userMail] || { email: userMail, products: [] };

    document.getElementById('addProductModal').style.display = 'none';
    displayProductList();

    function showAddProductModal() {
        document.getElementById('main').style.display = 'none';
        document.getElementById('addProductModal').style.display = 'block';        
        var itemId = currentUser.products.length + 1;
        document.getElementById('itemId').value = itemId;
    }

    function addProduct() {
        var itemId = document.getElementById('itemId').value;
        var itemName = document.getElementById('itemName').value;
        var itemPrice = document.getElementById('itemPrice').value;
        var itemDescription = document.getElementById('itemDescription').value;
        var itemImageURL = document.getElementById('itemURL').value;

        var newProduct = {
            id: itemId,
            name: itemName,
            price: itemPrice,
            description: itemDescription,
            imageUrl: itemImageURL
        };

        currentUser.products.push(newProduct);
        users[userMail] = currentUser;
        localStorage.setItem('users', JSON.stringify(users));
window.location.href="sellerDashboard.html"
document.getElementById('addProductModal').style.display = 'none';
displayProductList();
    }

    function deleteProduct(itemId) {
        // Remove product from the current user's products array
        currentUser.products = currentUser.products.filter(product => product.id != itemId);

        // Update the user data in localStorage
        users[userMail] = currentUser;
        localStorage.setItem('users', JSON.stringify(users));

        // Update product list
        displayProductList();
    }

    function displayProductList() {
        var productListDiv = document.getElementById('productList');
        productListDiv.innerHTML = '';

        if (currentUser.products.length === 0) {
            productListDiv.innerHTML = '<p>No products available.</p>';
        } else {
            currentUser.products.forEach(product => {
                var productDiv = document.createElement('div');
                productDiv.classList.add('product');

                var productInfo = `
                    <p><strong>ID:</strong> ${product.id}</p>
                    <p><strong>Name:</strong> ${product.name}</p>
                    <p><strong>Price:</strong> ${product.price}</p>
                    <p><strong>Description:</strong> ${product.description}</p>
                    <img src="${product.imageUrl}" alt="${product.name}" style="max-width: 100px;">
                    <button onclick="deleteProduct(${product.id})" class="custom-btn btn-1">Delete</button>
                    <button onclick="edit(${product.id})" class="custom-btn btn-1">Edit</button>
                    `;
                productDiv.innerHTML = productInfo;
                productListDiv.appendChild(productDiv);
            });
        }
    }
    function edit(itemId) {
    var product;

    for (var i = 0; i < currentUser.products.length; i++) {
        if (currentUser.products[i].id == itemId) {
            product = currentUser.products[i];
            break;
        }
    }

    document.getElementById('editItemId').value = product.id;
    document.getElementById('editItemName').value = product.name;
    document.getElementById('editItemPrice').value = product.price;
    document.getElementById('editItemDescription').value = product.description;
    document.getElementById('editItemURL').value = product.imageUrl;

    document.getElementById('main').style.display = 'none';
    document.getElementById('editProductModal').style.display = 'block';
}



function updateProduct() {
    var itemId = document.getElementById('editItemId').value;
    var itemName = document.getElementById('editItemName').value;
    var itemPrice = document.getElementById('editItemPrice').value;
    var itemDescription = document.getElementById('editItemDescription').value;
    var itemImageURL = document.getElementById('editItemURL').value;

    var productIndex = -1;

    for (var i = 0; i < currentUser.products.length; i++) {
        if (currentUser.products[i].id == itemId) {
            productIndex = i;
            break;
        }
    }

    if (productIndex > -1) {
        currentUser.products[productIndex] = {
            id: itemId,
            name: itemName,
            price: itemPrice,
            description: itemDescription,
            imageUrl: itemImageURL
        };

        users[userMail] = currentUser;
        localStorage.setItem('users', JSON.stringify(users));
        window.location.href = "sellerDashboard.html"
        document.getElementById('editProductModal').style.display = 'none';
        displayProductList();
    }
}


function closeEditModal() {
    document.getElementById('editProductModal').style.display = 'none';
    document.getElementById('main').style.display = 'block';
}


    function logout(){
        localStorage.removeItem('currentUser')
        window.location.href="index.html"
    }
</script>

</html>
